syntax = "proto3";

package proto;

import "google/protobuf/timestamp.proto";

service ApiService {
  rpc CreateSession(CreateSessionReq) returns (CreateSessionResp) {}
  rpc ValidateSession(ValidateSessionReq) returns (ValidateSessionResp) {}
  rpc DeleteSession(DeleteSessionReq) returns (DeleteSessionResp) {}

  rpc StartGoogleLogin(StartGoogleLoginReq) returns (StartGoogleLoginResp) {}
  rpc HandleGoogleCallback(HandleGoogleCallbackReq) returns (HandleGoogleCallbackResp);
  rpc StartGithubLogin(StartGithubLoginReq) returns (StartGithubLoginResp) {}
  rpc HandleGithubCallback(HandleGithubCallbackReq) returns (HandleGithubCallbackResp);
}

message Session {
  string token = 1;
}


message CreateSessionReq {
  string user_id = 1;
}

message CreateSessionResp {
    string token = 1;
}

message ValidateSessionReq {
  string token = 1;
}

message ValidateSessionResp {
  string user_id = 1;
  bool should_refresh_cookie = 2;
}

message DeleteSessionReq {
  string token = 1;
}

message DeleteSessionResp { }

message StartGoogleLoginReq { }

message StartGoogleLoginResp {
  string state = 1;
  string code_verifier = 2;
  string authorization_url = 3;
}

message HandleGoogleCallbackReq {
  string code = 1;
  string code_verifier = 2;
}

message HandleGoogleCallbackResp {
  string google_id = 1;
  string email = 2;
  string name = 3;
}

message StartGithubLoginReq { }

message StartGithubLoginResp {
  string state = 1;
  string authorization_url = 2;
}

message HandleGithubCallbackReq {
  string code = 1;
}

message HandleGithubCallbackResp {
  string github_id = 1;
  string email = 2;
  string name = 3;
}
